<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title><%= title %> | Football Hub</title>

  <!-- Bootstrap + Font Awesome + AOS + Google Fonts -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --warning-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      --info-gradient: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      --glass-bg: rgba(255, 255, 255, 0.25);
      --glass-border: rgba(255, 255, 255, 0.18);
      --text-primary: #2d3748;
      --text-secondary: #718096;
      --bg-primary: #f7fafc;
      --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.08);
      --shadow-medium: 0 8px 40px rgba(0, 0, 0, 0.12);
      --shadow-heavy: 0 20px 60px rgba(0, 0, 0, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      font-family: 'Inter', sans-serif;
      color: var(--text-primary);
      min-height: 100vh;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 75% 75%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
      pointer-events: none;
      z-index: -1;
    }

    /* Hero Section */
    .hero-section {
      background: transparent;
      color: white;
      padding: 4rem 0 3rem;
      text-align: center;
      position: relative;
    }

    .hero-title {
      font-family: 'Poppins', sans-serif;
      font-size: 3.5rem;
      font-weight: 800;
      margin-bottom: 1rem;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .hero-subtitle {
      font-size: 1.25rem;
      margin-bottom: 0;
      opacity: 0.9;
    }

    .admin-notice {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 50px;
      padding: 0.75rem 1.5rem;
      font-size: 0.9rem;
      margin-top: 1rem;
      display: inline-block;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    /* Main Content */
    .main-content {
      background: var(--bg-primary);
      min-height: 100vh;
      border-radius: 2rem 2rem 0 0;
      margin-top: -2rem;
      position: relative;
      z-index: 10;
      padding-top: 3rem;
    }

    /* Stats Cards */
    .stats-container {
      margin-bottom: 3rem;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 1.5rem;
      padding: 2rem;
      text-align: center;
      box-shadow: var(--shadow-light);
      border: 1px solid rgba(255, 255, 255, 0.2);
      margin-bottom: 1.5rem;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      transition: transform 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: var(--shadow-heavy);
    }

    .stat-card:nth-child(1)::before { background: var(--primary-gradient); }
    .stat-card:nth-child(2)::before { background: var(--danger-gradient); }
    .stat-card:nth-child(3)::before { background: var(--success-gradient); }
    .stat-card:nth-child(4)::before { background: var(--info-gradient); }

    .stat-card.age-young::before { background: var(--warning-gradient); }
    .stat-card.age-middle::before { background: var(--primary-gradient); }
    .stat-card.age-mature::before { background: var(--secondary-gradient); }

    .stat-icon {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      opacity: 0.8;
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: 800;
      font-family: 'Poppins', sans-serif;
      margin-bottom: 0.5rem;
    }

    .stat-label {
      color: var(--text-secondary);
      font-size: 0.9rem;
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 1px;
    }

    .stat-primary .stat-icon, .stat-primary .stat-number { color: #667eea; }
    .stat-danger .stat-icon, .stat-danger .stat-number { color: #fa709a; }
    .stat-success .stat-icon, .stat-success .stat-number { color: #4facfe; }
    .stat-info .stat-icon, .stat-info .stat-number { color: #a8edea; }
    .stat-warning .stat-icon, .stat-warning .stat-number { color: #43e97b; }
    .stat-secondary .stat-icon, .stat-secondary .stat-number { color: #f093fb; }

    /* Filter Section */
    .filter-section {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 2rem;
      padding: 2.5rem;
      margin-bottom: 3rem;
      box-shadow: var(--shadow-medium);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .filter-title {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 2rem;
      font-size: 1.5rem;
    }

    .form-label {
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .form-control, .form-select {
      border: 2px solid #e2e8f0;
      border-radius: 1rem;
      padding: 0.75rem 1rem;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .form-control:focus, .form-select:focus {
      border-color: #4facfe;
      box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
      transform: translateY(-1px);
    }

    .btn {
      border-radius: 50px;
      font-weight: 600;
      padding: 0.75rem 1.5rem;
      transition: all 0.3s ease;
      border: none;
    }

    .btn-primary {
      background: var(--primary-gradient);
      color: white;
    }

    .btn-outline-secondary {
      background: rgba(113, 128, 150, 0.1);
      border: 2px solid rgba(113, 128, 150, 0.3);
      color: var(--text-secondary);
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-light);
    }

    /* Section Headers */
    .section-header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 1.5rem;
      padding: 1.5rem 2rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow-light);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .section-title {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0;
      font-size: 1.5rem;
    }

    /* Member Cards */
    .member-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 2rem;
      box-shadow: var(--shadow-light);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      overflow: hidden;
      position: relative;
      margin-bottom: 2rem;
    }

    .member-card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: var(--shadow-heavy);
    }

    .member-card .card-body {
      padding: 2rem;
    }

    .member-avatar {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: var(--primary-gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
      font-weight: 800;
      font-family: 'Poppins', sans-serif;
      margin-right: 1.5rem;
      box-shadow: var(--shadow-light);
      flex-shrink: 0;
    }

    .card-title {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      color: var(--text-primary);
      font-size: 1.25rem;
      margin-bottom: 0.5rem;
    }

    .admin-badge {
      background: var(--danger-gradient);
      color: white;
      padding: 0.4rem 1rem;
      border-radius: 50px;
      font-size: 0.75rem;
      font-weight: 700;
      box-shadow: var(--shadow-light);
    }

    .member-badge {
      background: var(--success-gradient);
      color: white;
      padding: 0.4rem 1rem;
      border-radius: 50px;
      font-size: 0.75rem;
      font-weight: 700;
      box-shadow: var(--shadow-light);
    }

    .age-badge {
      background: var(--warning-gradient);
      color: #2d3748;
      padding: 0.4rem 0.8rem;
      border-radius: 50px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .comments-badge {
      background: var(--info-gradient);
      color: #2d3748;
      padding: 0.4rem 0.8rem;
      border-radius: 50px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    /* Empty State */
    .empty-state {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 2rem;
      box-shadow: var(--shadow-medium);
      padding: 4rem 2rem;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .empty-state i {
      font-size: 5rem;
      color: var(--text-secondary);
      margin-bottom: 2rem;
      opacity: 0.5;
    }

    .empty-state h4 {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 1rem;
    }

    .empty-state p {
      color: var(--text-secondary);
      font-size: 1.1rem;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .hero-title {
        font-size: 2.5rem;
      }
      
      .hero-subtitle {
        font-size: 1rem;
      }
      
      .stat-card {
        padding: 1.5rem;
      }
      
      .stat-icon {
        font-size: 2rem;
      }
      
      .stat-number {
        font-size: 2rem;
      }
      
      .filter-section {
        padding: 2rem 1.5rem;
      }
      
      .member-avatar {
        width: 60px;
        height: 60px;
        font-size: 1.25rem;
        margin-right: 1rem;
      }
      
      .member-card .card-body {
        padding: 1.5rem;
      }
      
      .section-header {
        padding: 1rem 1.5rem;
      }
    }
  </style>
</head>
<body>
  <%- include('../partials/navbar') %>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-8 mx-auto text-center">
          <h1 class="hero-title" data-aos="fade-up">
            <i class="fas fa-users me-3"></i>Members Management
          </h1>
          <p class="hero-subtitle" data-aos="fade-up" data-aos-delay="100">
            View and manage all registered members
          </p>
          <div class="admin-notice" data-aos="fade-up" data-aos-delay="200">
            <i class="fas fa-shield-alt me-2"></i>Admin Only Access
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="main-content">
    <div class="container">
      <%- include('../partials/alerts') %>

      <!-- Main Statistics -->
      <div class="stats-container" data-aos="fade-up" data-aos-delay="300">
        <div class="row">
          <div class="col-lg-3 col-md-6">
            <div class="stat-card stat-primary">
              <div class="stat-icon">
                <i class="fas fa-users"></i>
              </div>
              <div class="stat-number"><%= stats.totalMembers %></div>
              <div class="stat-label">Total Members</div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6">
            <div class="stat-card stat-danger">
              <div class="stat-icon">
                <i class="fas fa-crown"></i>
              </div>
              <div class="stat-number"><%= stats.adminCount %></div>
              <div class="stat-label">Administrators</div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6">
            <div class="stat-card stat-success">
              <div class="stat-icon">
                <i class="fas fa-user"></i>
              </div>
              <div class="stat-number"><%= stats.memberCount %></div>
              <div class="stat-label">Regular Members</div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6">
            <div class="stat-card stat-info">
              <div class="stat-icon">
                <i class="fas fa-user-plus"></i>
              </div>
              <div class="stat-number"><%= stats.recentMembers %></div>
              <div class="stat-label">New (30 days)</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Age Distribution -->
      <div class="stats-container" data-aos="fade-up" data-aos-delay="400">
        <div class="row">
          <div class="col-lg-4 col-md-4">
            <div class="stat-card age-young stat-warning">
              <div class="stat-icon">
                <i class="fas fa-seedling"></i>
              </div>
              <div class="stat-number"><%= stats.ageRanges.young %></div>
              <div class="stat-label">Young (&lt; 25)</div>
            </div>
          </div>
          <div class="col-lg-4 col-md-4">
            <div class="stat-card age-middle stat-primary">
              <div class="stat-icon">
                <i class="fas fa-user-tie"></i>
              </div>
              <div class="stat-number"><%= stats.ageRanges.middle %></div>
              <div class="stat-label">Middle (25-35)</div>
            </div>
          </div>
          <div class="col-lg-4 col-md-4">
            <div class="stat-card age-mature stat-secondary">
              <div class="stat-icon">
                <i class="fas fa-user-graduate"></i>
              </div>
              <div class="stat-number"><%= stats.ageRanges.mature %></div>
              <div class="stat-label">Mature (&gt; 35)</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Search and Filter Section -->
      <div class="filter-section" data-aos="fade-up" data-aos-delay="500">
        <h3 class="filter-title">
          <i class="fas fa-filter text-primary me-2"></i>Search & Filter Members
        </h3>
        
        <form method="GET" action="/accounts" class="row g-3">
          <div class="col-md-4">
            <label for="search" class="form-label">
              <i class="fas fa-search text-primary me-2"></i>Search Members
            </label>
            <input type="text" 
                   class="form-control" 
                   id="search" 
                   name="search" 
                   placeholder="Search by name or username..."
                   value="<%= search %>">
          </div>
          
          <div class="col-md-3">
            <label for="role" class="form-label">
              <i class="fas fa-user-cog text-primary me-2"></i>Filter by Role
            </label>
            <select class="form-select" id="role" name="role">
              <option value="">All Members</option>
              <option value="admin" <%= selectedRole === 'admin' ? 'selected' : '' %>>Administrators</option>
              <option value="member" <%= selectedRole === 'member' ? 'selected' : '' %>>Regular Members</option>
            </select>
          </div>
          
          <div class="col-md-3">
            <label for="sort" class="form-label">
              <i class="fas fa-sort text-primary me-2"></i>Sort by
            </label>
            <select class="form-select" id="sort" name="sort">
              <option value="name" <%= selectedSort === 'name' ? 'selected' : '' %>>Name (A-Z)</option>
              <option value="username" <%= selectedSort === 'username' ? 'selected' : '' %>>Username (A-Z)</option>
              <option value="age_asc" <%= selectedSort === 'age_asc' ? 'selected' : '' %>>Age (Youngest first)</option>
              <option value="age_desc" <%= selectedSort === 'age_desc' ? 'selected' : '' %>>Age (Oldest first)</option>
              <option value="newest" <%= selectedSort === 'newest' ? 'selected' : '' %>>Newest first</option>
              <option value="oldest" <%= selectedSort === 'oldest' ? 'selected' : '' %>>Oldest first</option>
            </select>
          </div>
          
          <div class="col-md-2 d-flex align-items-end">
            <button type="submit" class="btn btn-primary w-100">
              <i class="fas fa-search me-1"></i>Apply
            </button>
          </div>
        </form>
        
        <% if (search || selectedRole || selectedSort !== 'name') { %>
          <div class="mt-3">
            <a href="/accounts" class="btn btn-outline-secondary btn-sm">
              <i class="fas fa-times me-2"></i>Clear Filters
            </a>
          </div>
        <% } %>
      </div>

      <!-- Members Section Header -->
      <div class="section-header" data-aos="fade-up" data-aos-delay="600">
        <div class="row align-items-center">
          <div class="col-md-12">
            <h3 class="section-title">
              <i class="fas fa-list text-primary me-2"></i>
              Members List (<%= members.length %>)
            </h3>
          </div>
        </div>
      </div>

      <!-- Members Grid -->
      <% if (members.length === 0) { %>
        <div class="empty-state" data-aos="fade-up" data-aos-delay="700">
          <i class="fas fa-users"></i>
          <h4>No Members Found</h4>
          <p>Try adjusting your search or filter criteria</p>
        </div>
      <% } else { %>
        <div class="row">
          <% members.forEach((member, index) => { %>
            <div class="col-lg-6 col-xl-4 mb-4">
              <div class="member-card card h-100" data-aos="fade-up" data-aos-delay="<%= 700 + (index * 50) %>">
                <div class="card-body">
                  <div class="d-flex align-items-start">
                    <div class="member-avatar">
                      <%= member.name.charAt(0).toUpperCase() %>
                    </div>
                    <div class="flex-grow-1">
                      <div class="d-flex justify-content-between align-items-start mb-2">
                        <div>
                          <h5 class="card-title"><%= member.name %></h5>
                          <p class="text-muted mb-0 small">@<%= member.membername %></p>
                        </div>
                        <div>
                          <% if (member.isAdmin) { %>
                            <span class="admin-badge">
                              <i class="fas fa-crown me-1"></i>Admin
                            </span>
                          <% } else { %>
                            <span class="member-badge">
                              <i class="fas fa-user me-1"></i>Member
                            </span>
                          <% } %>
                        </div>
                      </div>
                      
                      <div class="row g-2 mb-3">
                        <div class="col-6">
                          <small class="text-muted d-block mb-1">Age</small>
                          <span class="age-badge">
                            <i class="fas fa-birthday-cake me-1"></i><%= member.age %> years
                          </span>
                        </div>
                        <div class="col-6">
                          <small class="text-muted d-block mb-1">Comments</small>
                          <span class="comments-badge">
                            <i class="fas fa-comments me-1"></i><%= member.commentCount %>
                          </span>
                        </div>
                      </div>
                      
                      <div class="row g-2">
                        <div class="col-6">
                          <small class="text-muted d-block">Born</small>
                          <small class="fw-bold text-primary"><%= member.YOB %></small>
                        </div>
                        <div class="col-6">
                          <small class="text-muted d-block">Joined</small>
                          <small class="fw-bold text-primary">
                            <%= new Date(member.createdAt).toLocaleDateString() %>
                          </small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          <% }) %>
        </div>
      <% } %>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>

  <script>
    // Initialize AOS
    AOS.init({
      duration: 800,
      easing: 'ease-out-cubic',
      once: true,
      offset: 100
    });
  </script>

  <%- include('../partials/scripts') %>
</body>
</html>